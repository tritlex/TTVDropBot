{
  "version": 3,
  "sources": ["../../../../src/functions/handler/restartHandler.ts"],
  "sourcesContent": ["import {WatchingEventHandlerStop} from \"./watchpageHandler\";\nimport {askWhatDropToStart, askWhatGameToWatch, getActiveCampaigns, getTwitchDrops} from \"../get/getTwitchDrops\";\nimport {startWatching} from \"../startWatching\";\nimport {userdata} from \"../../index\" ;\nimport winston from \"winston\";\nimport chalk from \"chalk\";\nimport {delay, getRandomInt} from \"../../utils/util\";\n\n\nexport async function restartHandler(random: boolean, filterlive: boolean, filterNonActive: boolean, filterlast: boolean, newgame: boolean) {\n    if (!newgame) {\n        await WatchingEventHandlerStop()\n        await askWhatDropToStart(random, filterlive, filterNonActive, filterlast)\n        await startWatching()\n    } else if (newgame && userdata.settings.Prioritylist.length > 0) {\n        await WatchingEventHandlerStop()\n        await selectGamefromList()\n        await getTwitchDrops(userdata.game, true).then(async () => {\n            await askWhatDropToStart(random, filterlive, filterNonActive, filterlast)\n            await startWatching()\n        })\n    } else {\n        await WatchingEventHandlerStop()\n        await askWhatGameToWatch(true)\n        await getTwitchDrops(userdata.game, true).then(async () => {\n            await askWhatDropToStart(random, filterlive, filterNonActive, filterlast)\n            await startWatching()\n        })\n    }\n}\n\nasync function selectGamefromList() {\n    let activecampainnames = await getActiveCampaigns();\n\n    if (userdata.settings.Prioritylist.length === 0) {\n        winston.warn(chalk.yellow('Warning: Please add Games to your Priority List, otherwise the bot will select a random game... or disable this feature in the settings...'))\n        userdata.game = activecampainnames[getRandomInt(userdata.availableDropNameChoices.length)]\n        winston.info(chalk.gray('Selected a random Game to watch: ' + chalk.white(userdata.game)))\n    } else {\n        let gameselected = ''\n        for (const [i, game] of userdata.settings.Prioritylist.entries()) {\n            if (userdata.game === game) {\n                if ((userdata.settings.Prioritylist.length-1) === i) {\n                    gameselected = userdata.settings.Prioritylist[0]\n                } else {\n                    gameselected = userdata.settings.Prioritylist[i+1]\n                }\n            }\n        }\n        if (gameselected === '') gameselected = userdata.settings.Prioritylist[0]\n        userdata.game = gameselected\n        winston.silly(\" \")\n        winston.info(chalk.gray('Selected ') + chalk.white(gameselected) + chalk.gray(' as next game from your Priority list... Watching in 45 seconds...'), {event: \"newGame\"})\n        winston.silly(' ', {event: \"progressEnd\"})\n        await delay(45000)\n    }\n}\n\n\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA,8BAAuC;AACvC,4BAAyF;AACzF,2BAA4B;AAC5B,eAAuB;AACvB,qBAAoB;AACpB,mBAAkB;AAClB,kBAAkC;AAGlC,8BAAqC,QAAiB,YAAqB,iBAA0B,YAAqB,SAAkB;AACxI,MAAI,CAAC,SAAS;AACV,UAAM;AACN,UAAM,8CAAmB,QAAQ,YAAY,iBAAiB;AAC9D,UAAM;AAAA,aACC,WAAW,kBAAS,SAAS,aAAa,SAAS,GAAG;AAC7D,UAAM;AACN,UAAM;AACN,UAAM,0CAAe,kBAAS,MAAM,MAAM,KAAK,YAAY;AACvD,YAAM,8CAAmB,QAAQ,YAAY,iBAAiB;AAC9D,YAAM;AAAA;AAAA,SAEP;AACH,UAAM;AACN,UAAM,8CAAmB;AACzB,UAAM,0CAAe,kBAAS,MAAM,MAAM,KAAK,YAAY;AACvD,YAAM,8CAAmB,QAAQ,YAAY,iBAAiB;AAC9D,YAAM;AAAA;AAAA;AAAA;AAKlB,oCAAoC;AAChC,MAAI,qBAAqB,MAAM;AAE/B,MAAI,kBAAS,SAAS,aAAa,WAAW,GAAG;AAC7C,2BAAQ,KAAK,qBAAM,OAAO;AAC1B,sBAAS,OAAO,mBAAmB,8BAAa,kBAAS,yBAAyB;AAClF,2BAAQ,KAAK,qBAAM,KAAK,sCAAsC,qBAAM,MAAM,kBAAS;AAAA,SAChF;AACH,QAAI,eAAe;AACnB,eAAW,CAAC,GAAG,SAAS,kBAAS,SAAS,aAAa,WAAW;AAC9D,UAAI,kBAAS,SAAS,MAAM;AACxB,YAAK,kBAAS,SAAS,aAAa,SAAO,MAAO,GAAG;AACjD,yBAAe,kBAAS,SAAS,aAAa;AAAA,eAC3C;AACH,yBAAe,kBAAS,SAAS,aAAa,IAAE;AAAA;AAAA;AAAA;AAI5D,QAAI,iBAAiB;AAAI,qBAAe,kBAAS,SAAS,aAAa;AACvE,sBAAS,OAAO;AAChB,2BAAQ,MAAM;AACd,2BAAQ,KAAK,qBAAM,KAAK,eAAe,qBAAM,MAAM,gBAAgB,qBAAM,KAAK,uEAAuE,EAAC,OAAO;AAC7J,2BAAQ,MAAM,KAAK,EAAC,OAAO;AAC3B,UAAM,uBAAM;AAAA;AAAA;",
  "names": []
}
