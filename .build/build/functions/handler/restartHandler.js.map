{
  "version": 3,
  "sources": ["../../../../build/functions/handler/restartHandler.js"],
  "sourcesContent": ["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.restartHandler = void 0;\nconst watchpageHandler_1 = require(\"./watchpageHandler\");\nconst getTwitchDrops_1 = require(\"../get/getTwitchDrops\");\nconst startWatching_1 = require(\"../startWatching\");\nconst index_1 = require(\"../../index\");\nconst winston_1 = __importDefault(require(\"winston\"));\nconst chalk_1 = __importDefault(require(\"chalk\"));\nconst util_1 = require(\"../../utils/util\");\nfunction restartHandler(random, filterlive, filterNonActive, filterlast, newgame) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!newgame) {\n            yield (0, watchpageHandler_1.WatchingEventHandlerStop)();\n            yield (0, getTwitchDrops_1.askWhatDropToStart)(random, filterlive, filterNonActive, filterlast);\n            yield (0, startWatching_1.startWatching)();\n        }\n        else if (newgame && index_1.userdata.settings.Prioritylist.length > 0) {\n            yield (0, watchpageHandler_1.WatchingEventHandlerStop)();\n            yield selectGamefromList();\n            yield (0, getTwitchDrops_1.getTwitchDrops)(index_1.userdata.game, true).then(() => __awaiter(this, void 0, void 0, function* () {\n                yield (0, getTwitchDrops_1.askWhatDropToStart)(random, filterlive, filterNonActive, filterlast);\n                yield (0, startWatching_1.startWatching)();\n            }));\n        }\n        else {\n            yield (0, watchpageHandler_1.WatchingEventHandlerStop)();\n            yield (0, getTwitchDrops_1.askWhatGameToWatch)(true);\n            yield (0, getTwitchDrops_1.getTwitchDrops)(index_1.userdata.game, true).then(() => __awaiter(this, void 0, void 0, function* () {\n                yield (0, getTwitchDrops_1.askWhatDropToStart)(random, filterlive, filterNonActive, filterlast);\n                yield (0, startWatching_1.startWatching)();\n            }));\n        }\n    });\n}\nexports.restartHandler = restartHandler;\nfunction selectGamefromList() {\n    return __awaiter(this, void 0, void 0, function* () {\n        let activecampainnames = yield (0, getTwitchDrops_1.getActiveCampaigns)();\n        if (index_1.userdata.settings.Prioritylist.length === 0) {\n            winston_1.default.warn(chalk_1.default.yellow('Warning: Please add Games to your Priority List, otherwise the bot will select a random game... or disable this feature in the settings...'));\n            index_1.userdata.game = activecampainnames[(0, util_1.getRandomInt)(index_1.userdata.availableDropNameChoices.length)];\n            winston_1.default.info(chalk_1.default.gray('Selected a random Game to watch: ' + chalk_1.default.white(index_1.userdata.game)));\n        }\n        else {\n            let gameselected = '';\n            for (const [i, game] of index_1.userdata.settings.Prioritylist.entries()) {\n                if (index_1.userdata.game === game) {\n                    if ((index_1.userdata.settings.Prioritylist.length - 1) === i) {\n                        gameselected = index_1.userdata.settings.Prioritylist[0];\n                    }\n                    else {\n                        gameselected = index_1.userdata.settings.Prioritylist[i + 1];\n                    }\n                }\n            }\n            if (gameselected === '')\n                gameselected = index_1.userdata.settings.Prioritylist[0];\n            index_1.userdata.game = gameselected;\n            winston_1.default.silly(\" \");\n            winston_1.default.info(chalk_1.default.gray('Selected ') + chalk_1.default.white(gameselected) + chalk_1.default.gray(' as next game from your Priority list... Watching in 45 seconds...'), { event: \"newGame\" });\n            winston_1.default.silly(' ', { event: \"progressEnd\" });\n            yield (0, util_1.delay)(45000);\n        }\n    });\n}\n"],
  "mappings": "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",
  "names": []
}
